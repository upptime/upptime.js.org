(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{81:function(e,t,i){"use strict";i.r(t),i.d(t,"frontMatter",(function(){return o})),i.d(t,"metadata",(function(){return s})),i.d(t,"rightToc",(function(){return u})),i.d(t,"default",(function(){return l}));var n=i(2),a=i(6),r=(i(0),i(96)),o={title:"Triggers"},s={unversionedId:"triggers",id:"triggers",isDocsHomePage:!1,title:"Triggers",description:"By default, uptime is checked every 5 minutes and response time graphs and endpoints are updated every 24 hours. You can also manually trigger an update, for example after setting up your repository. Manual triggers are powered by workflow triggers on GitHub Actions.",source:"@site/docs/triggers.md",slug:"/triggers",permalink:"/docs/triggers",editUrl:"https://github.com/upptime/upptime.js.org/blob/master/docs/triggers.md",version:"current",sidebar:"sidebar",previous:{title:"Scheduled maintenance",permalink:"/docs/scheduled-maintenance"},next:{title:"Notifications",permalink:"/docs/notifications"}},u=[{value:"Available workflows",id:"available-workflows",children:[{value:"Setup CI",id:"setup-ci",children:[]},{value:"Uptime CI",id:"uptime-ci",children:[]},{value:"Update Template CI",id:"update-template-ci",children:[]},{value:"Static Site CI",id:"static-site-ci",children:[]},{value:"Graphs CI",id:"graphs-ci",children:[]},{value:"Response Time CI",id:"response-time-ci",children:[]},{value:"Summary CI",id:"summary-ci",children:[]}]},{value:"Manual triggers",id:"manual-triggers",children:[{value:"Using the GitHub UI",id:"using-the-github-ui",children:[]},{value:"Using the GitHub API",id:"using-the-github-api",children:[]}]}],c={rightToc:u};function l(e){var t=e.components,i=Object(a.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},c,i,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"By default, uptime is checked every 5 minutes and response time graphs and endpoints are updated every 24 hours. You can also manually trigger an update, for example after setting up your repository. Manual triggers are powered by workflow triggers on GitHub Actions."),Object(r.b)("h2",{id:"available-workflows"},"Available workflows"),Object(r.b)("p",null,"Upptime has several workflows that are run on different intervals, all of which you can also manually trigger:"),Object(r.b)("h3",{id:"setup-ci"},"Setup CI"),Object(r.b)("p",null,"This workflow is triggered after you edit the configuration file, and runs alls steps: checking uptime, tracking response time, updating the README, and generating graphs. If you want to \"force\" Upptime to run everything once (for example, after you've set up the template or after you've made a configuration change), you can manually trigger Setup CI."),Object(r.b)("h3",{id:"uptime-ci"},"Uptime CI"),Object(r.b)("p",null,"This workflow runs once every 5 minutes and checks if your websites are up. If they are down, it creates a new issue in your repository. This same workflow also closes any issues after your websites have come back up. If you want to manually make sure that all your endpoints are currently up, you can trigger this workflow."),Object(r.b)("h3",{id:"update-template-ci"},"Update Template CI"),Object(r.b)("p",null,"This workflow runs once a week and updates the internal code of Upptime to make sure you're always on the latest version. This is important because Upptime is still in development and may include new design updates and feature changes including important security updates."),Object(r.b)("h3",{id:"static-site-ci"},"Static Site CI"),Object(r.b)("p",null,"This workflow builds and deploys your status page website using GitHub Pages. It reads from your configuration and builds the Svelte/Sapper website, then deploys is to the ",Object(r.b)("inlineCode",{parentName:"p"},"gh-pages")," branch and triggers a re-build on GitHub Pages. By default, this runs once every week, but you can manually run it, for example after updating your configuration or setting up the template."),Object(r.b)("h3",{id:"graphs-ci"},"Graphs CI"),Object(r.b)("p",null,"This workflow runs once every day and generates response time graphs from the recorded data. These PNG images are stored in the ",Object(r.b)("inlineCode",{parentName:"p"},"graphs")," directory and embedded on the project's README. You can manually run this to regenerate those images."),Object(r.b)("h3",{id:"response-time-ci"},"Response Time CI"),Object(r.b)("p",null,"This workflow records the reponse time of each endpoint and commits it to git history, which is why it runs once every day. You can manually trigger it if you want to record the response time manually."),Object(r.b)("h3",{id:"summary-ci"},"Summary CI"),Object(r.b)("p",null,"This workflow also runs once every day and updates the README of your project with a summary of the response times and generated graphs. You can manually trigger it to update your project's README.md file."),Object(r.b)("h2",{id:"manual-triggers"},"Manual triggers"),Object(r.b)("p",null,"To manually trigger an update, you can use the GitHub UI or API."),Object(r.b)("h3",{id:"using-the-github-ui"},"Using the GitHub UI"),Object(r.b)("p",null,'First, click on the "Actions" tab of your GitHub repository. You will reach the URL ',Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/user/repo/actions"}),"https://github.com/user/repo/actions"),", where ",Object(r.b)("inlineCode",{parentName:"p"},"user")," is your GitHub username and ",Object(r.b)("inlineCode",{parentName:"p"},"repo")," is the name of the repository."),Object(r.b)("p",null,'On the left sidebar under "Workflows", click on the workflow you want to trigger, for example "Setup CI":'),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"https://user-images.githubusercontent.com/2841780/97270440-2c553300-1855-11eb-9388-4a4d007aad0a.png",alt:"Screenshot of Workflows tab"}))),Object(r.b)("p",null,'You will see the message "This workflow has a ',Object(r.b)("inlineCode",{parentName:"p"},"workflow_dispatch"),' event trigger.". Click on the "Run workflow" button on the right. Keep the default branch select and click on "Run workflow":'),Object(r.b)("p",null,Object(r.b)("img",Object(n.a)({parentName:"p"},{src:"https://user-images.githubusercontent.com/2841780/97270513-4e4eb580-1855-11eb-92ef-ad09780af797.png",alt:"Screenshot of the dispatch event"}))),Object(r.b)("h3",{id:"using-the-github-api"},"Using the GitHub API"),Object(r.b)("p",null,"If you want to programmatically trigger updates, you can use the GitHub REST API's repository dispatch events by triggering an event in your repository called ",Object(r.b)("inlineCode",{parentName:"p"},"Uptime CI")," located in the file ",Object(r.b)("inlineCode",{parentName:"p"},"uptime.yml")," (to trigger the Setup CI workflow, you change ",Object(r.b)("inlineCode",{parentName:"p"},"uptime.yml")," to ",Object(r.b)("inlineCode",{parentName:"p"},"setup.yml"),"):"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),' curl \\\n   -X POST \\\n   -H "Accept: application/vnd.github+json" \\\n   -H "Authorization: Bearer {YOUR GITHUB TOKEN}" \\\n   -H "X-GitHub-Api-Version: 2022-11-28" \\\n   -d \'{"ref": "master"}\' \\           \n   https://api.github.com/repos/{YOUR GITHUB USERNAME}/{YOUR UPPTIME REPO NAME}/actions/workflows/uptime.yml/dispatches\n')),Object(r.b)("p",null,"To get your GitHub token, simply go to settings -> Developer settings -> Personal access tokens. You have two options:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Fine-grained tokens or"),Object(r.b)("li",{parentName:"ul"},"Tokens (classic)")),Object(r.b)("p",null,'Fine-grained tokens may still be in beta when you use this. Once you choose one, select the "Generate new token" button.\nFine grained tokens ae preferred as you can limit the token to a specific repository.'),Object(r.b)("p",null,"In either case Type any note or name you wish, and set Expiration to anything you wish too (",Object(r.b)("em",{parentName:"p"},"I recommend make it never expire"),")."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},'If you are using the fine-grained token option, create a token with "Repository access" restricted to ',Object(r.b)("inlineCode",{parentName:"li"},"{YOUR UPPTIME REPO NAME}"),'.\nOnce you have selected a repository, under "Repository permissions", set "Actions" to read and write permissions.'),Object(r.b)("li",{parentName:"ul"},'If you are using the classic tokens,  in "Select scopes" select on ',Object(r.b)("em",{parentName:"li"},"workflow"),".")),Object(r.b)("p",null,"Then generate your new token using the button at the bottom of the page and save it somewhere safe. "),Object(r.b)("p",null,"Or, with JavaScript (",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/octokit/core.js"}),"@octokit/core.js"),") (untested):"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),'await octokit.request("POST /repos/{owner}/{repo}/actions/workflows/uptime.yml/dispatches", {\n  owner: "user",\n  repo: "repo",\n  ref: "master",\n});\n')),Object(r.b)("p",null,"For more information, read this article on the GitHub website: ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.github.com/en/actions/managing-workflow-runs/manually-running-a-workflow"}),"Create a repository dispatch event"),"."))}l.isMDXComponent=!0}}]);